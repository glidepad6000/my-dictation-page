<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è‹±æ–‡è½å¯«ç·´ç¿’</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    #videoInput {
      width: 100%;
      padding: 8px;
      font-size: 16px;
    }
    #videoContainer {
      margin-top: 20px;
    }
    iframe {
      width: 640px;
      height: 360px;
      border: none;
    }
    #dictationArea {
      margin-top: 40px;
    }
    #toolbar button {
      margin-right: 5px;
      margin-bottom: 5px;
    }
    #editor {
      border: 1px solid #ccc;
      padding: 10px;
      min-height: 200px;
      font-size: 16px;
      line-height: 1.5;
    }
  </style>
</head>
<body>

  <h2>ğŸ¬ å½±ç‰‡å€</h2>
  <input id="videoInput" type="text" placeholder="è²¼ä¸Š Bilibili æˆ– YouTube å½±ç‰‡ç¶²å€å¾ŒæŒ‰ Enter">
  <div id="videoContainer"></div>

  <div id="dictationArea">
    <h2>ğŸ“ è½å¯«å€</h2>
    <div id="toolbar">
      <button onclick="format('bold')">ç²—é«”</button>
      <button onclick="format('italic')">æ–œé«”</button>
      <button onclick="format('underline')">åº•ç·š</button>
      <button onclick="format('strikeThrough')">åˆªé™¤ç·š</button>
      <button onclick="insertFold()">æ’å…¥æŠ˜ç–Šå€å¡Š</button>
      <button onclick="removeFold()">åˆªé™¤é¸å–çš„æŠ˜ç–Šå€</button>
      <button onclick="insertColor('ğŸ”´')">ğŸ”´</button>
      <button onclick="insertColor('ğŸ©·')">ğŸ©·</button>
      <button onclick="insertColor('ğŸŸ¡')">ğŸŸ¡</button>
    </div>
    <div id="editor" contenteditable="true">
      åœ¨æ­¤è¼¸å…¥è½å¯«å…§å®¹...
    </div>
  </div>

  <script>
    // ğŸ¬ å½±ç‰‡åµŒå…¥é‚è¼¯
    const input = document.getElementById('videoInput');
    const container = document.getElementById('videoContainer');

    input.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        const url = input.value.trim();

        const biliMatch = url.match(/bilibili\.com\/video\/(BV\w+)/);
        if (biliMatch) {
          const bvid = biliMatch[1];
          container.innerHTML = `
            <iframe src="https://player.bilibili.com/player.html?bvid=${bvid}&autoplay=0"
                    allowfullscreen></iframe>`;
          return;
        }

        const ytMatch = url.match(/(?:youtube\.com\/watch\\?v=|youtu\\.be\\/)([\\w-]{11})/);
        if (ytMatch) {
          const vid = ytMatch[1];
          container.innerHTML = `
            <iframe src="https://www.youtube.com/embed/${vid}"
                    allowfullscreen></iframe>`;
          return;
        }

        container.innerHTML = `<p style="color:red;">âš ï¸ ç„¡æ³•è¾¨è­˜çš„å½±ç‰‡ç¶²å€</p>`;
      }
    });

    // ğŸ“ è½å¯«æ ¼å¼å·¥å…·åˆ—åŠŸèƒ½
    function format(command) {
      document.execCommand(command, false, null);
    }

    function insertFold() {
      const selection = window.getSelection();
      if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const fold = document.createElement('details');
        const summary = document.createElement('summary');
        summary.textContent = 'ğŸ”½ æ‘ºç–Šå…§å®¹';
        fold.appendChild(summary);
        const content = document.createElement('div');
        content.innerHTML = range.toString();
        fold.appendChild(content);
        range.deleteContents();
        range.insertNode(fold);
      }
    }

    function removeFold() {
      const selection = window.getSelection();
      if (selection.rangeCount > 0) {
        const node = selection.anchorNode;
        const fold = node.closest('details');
        if (fold) fold.remove();
      }
    }

    function insertColor(symbol) {
      const selection = window.getSelection();
      if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        range.deleteContents();
        range.insertNode(document.createTextNode(symbol));
      }
    }
  </script>

</body>
</html>
